There is a binary with setuid that runs with flag10 permissions and a token file that can only be read by flag10. We decompiled the binary with ghidra, and see that it opens a file which path is given as 1st arg to a host given to 2nd arg with port 6969. Before the call to open (which uses the effective uid), a call to access() is made to make sure that the real uid has the rights to do so as well. Reading the access() man, a warning is given to developpers that you shouldn't use access prior to a call to read() as a user might "exploit the short time interval between checking and opening the file".. This is exactly the case we are in. By running a script that makes a symlink to a file which we have access to and changing it to the token file in a loop, we can exploit this. 
We run the 3 scripts and get the password to flag10 : woupa2yuojeeaaed06riuj63c
